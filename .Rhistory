df <- df[,-1]
df <- subset(df, select = -Effect.size.code)
write.csv(df, here("Data", "Combined_effectsizes.csv"))
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
### Read in effect size data
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
rdata$es_reproduction <- rdata$es
rdata$v_reproduction <- rdata$v
rdata <- subset(rdata, select = -es)
rdata <- subset(rdata, select = -v)
View(rdata)
alllong$es_longevity <- alllong$es
alllong$v_longevity <- alllong$v
alllong <- subset(alllong, select = -es)
alllong <- subset(alllong, select = -v)
df <- merge(rdata, alllong, all=TRUE)
df <- subset(df, select = -(Trait.category))
df <- subset(df, select = -(Trait))
df <- df[,-1]
df <- subset(df, select = -Effect.size.code)
View(df)
write.csv(df, here("Data", "Combined_effectsizes.csv"))
allrows <- rbind(rdata[,1:35], alllong[,1:35])
combo_data <- allrows
combo_data$es.reproduction <- NA
combo_data$v.reproduction <- NA
combo_data$es.longevity <- NA
combo_data$v.longevity <- NA
View(combo_data)
for (i in 1:nrow(combo_data)) {
cat("Calculating row", i, "/2804", "\n")
is_matching_r <- rep(FALSE, nrow(rdata))
is_matching_l <- rep(FALSE, nrow(alllong))
# for every row of allrows find matching row in rdata and alllong
for (j in 1:nrow(rdata)) {
if (all(allrows[i, 1:35] == rdata[j, 1:35], na.rm=T)) {
is_matching_r[j] <- TRUE
break  # Break out of the loop once a match is found
}
}
for (j in 1:nrow(alllong)) {
if (all(allrows[i, 1:35] == alllong[j, 1:35], na.rm=T)) {
is_matching_l[j] <- TRUE
break  # Break out of the loop once a match is found
}
}
if (any(is_matching_r)) {
# Extract values from rdata and assign to combo_data
combo_data$es.reproduction[i] <- rdata$es_reproduction[is_matching_r]
combo_data$v.reproduction[i] <- rdata$v_reproduction[is_matching_r]
}
if (any(is_matching_l)) {
# Extract values from alllong and assign to combo_data
combo_data$es.longevity[i] <- alllong$es_longevity[is_matching_l]
combo_data$v.longevity[i] <- alllong$v_longevity[is_matching_l]
}
}
View(combo_data)
write.csv(combo_data, "Data/combined_effectsizes.csv")
u_combo <- unique(combo_data)
View(u_combo)
View(combo_data)
df_cleaned <- u_combo[!is.na(u_combo$es.reproduction), ]
df_cleaned <- df_cleaned[!is.na(df_cleaned$es.longevity), ]
View(rdata)
View(alllong)
rdata <- rdata[,-1]
alllong <- alllong[,-1]
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
rdata <- rdata[,-1]
### Read in effect size data
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
alllong <- alllong[,-1]
rdata$es_reproduction <- rdata$es
rdata$v_reproduction <- rdata$v
rdata <- subset(rdata, select = -es)
rdata <- subset(rdata, select = -v)
alllong$es_longevity <- alllong$es
alllong$v_longevity <- alllong$v
alllong <- subset(alllong, select = -es)
alllong <- subset(alllong, select = -v)
df <- merge(rdata, alllong, all=TRUE)
df <- subset(df, select = -(Trait.category))
df <- subset(df, select = -(Trait))
df <- df[,-1]
df <- subset(df, select = -Effect.size.code)
View(df)
View(alllong)
alllong <- alllong[,-1]
View(alllong)
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
function (x, df1, df2, ncp, log = FALSE)
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
rdata <- rdata[,-1]
View(rdata)
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
View(rdata)
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
View(rdata)
### Read in effect size data
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
View(alllong)
rdata$es_reproduction <- rdata$es
rdata$v_reproduction <- rdata$v
rdata <- subset(rdata, select = -es)
rdata <- subset(rdata, select = -v)
alllong$es_longevity <- alllong$es
alllong$v_longevity <- alllong$v
alllong <- subset(alllong, select = -es)
alllong <- subset(alllong, select = -v)
df <- merge(rdata, alllong, all=TRUE)
df <- subset(df, select = -(Trait.category))
df <- subset(df, select = -(Trait))
df <- df[,-1]
df <- subset(df, select = -Effect.size.code)
write.csv(df, here("Data", "Combined_effectsizes.csv"))
View(df)
allrows <- rbind(rdata[,1:35], alllong[,1:35])
combo_data <- allrows
View(combo_data)
combo_data$es.reproduction <- NA
combo_data$v.reproduction <- NA
combo_data$es.longevity <- NA
combo_data$v.longevity <- NA
View(combo_data)
View(combo_data)
View(rdata)
View(alllong)
colnames(combo_data)
colnames(rdata)
View(allrows)
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
### Read in effect size data
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
rdata$es_reproduction <- rdata$es
rdata$v_reproduction <- rdata$v
rdata <- subset(rdata, select = -es)
rdata <- subset(rdata, select = -v)
alllong$es_longevity <- alllong$es
alllong$v_longevity <- alllong$v
alllong <- subset(alllong, select = -es)
alllong <- subset(alllong, select = -v)
df <- merge(rdata, alllong, all=TRUE)
df <- subset(df, select = -(Trait.category))
df <- subset(df, select = -(Trait))
df <- df[,-1]
df <- subset(df, select = -Effect.size.code)
write.csv(df, here("Data", "Combined_effectsizes.csv"))
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
### Read in effect size data
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
rdata$es_reproduction <- rdata$es
rdata$v_reproduction <- rdata$v
rdata <- subset(rdata, select = -es)
rdata <- subset(rdata, select = -v)
alllong$es_longevity <- alllong$es
alllong$v_longevity <- alllong$v
alllong <- subset(alllong, select = -es)
alllong <- subset(alllong, select = -v)
df <- merge(rdata, alllong, all=TRUE)
df <- subset(df, select = -(Trait.category))
df <- subset(df, select = -(Trait))
df <- df[,-1]
df <- subset(df, select = -Effect.size.code)
write.csv(df, here("Data", "Combined_effectsizes.csv"))
colnames(rdata)
colnames(alllong)
colnames(df)
write.csv(df, here("Data", "Combined_effectsizes.csv"))
rdata[,35]
rdata[,34]
colnames(rdata)
rdata[, "Status":"Paper.code"]
allrows <- rbind(rdata[,1:38], alllong[,1:38])
View(allrows)
View(df)
View(rdata)
View(alllong)
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
### Read in effect size data
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
rdata$es_reproduction <- rdata$es
rdata$v_reproduction <- rdata$v
rdata <- subset(rdata, select = -es)
rdata <- subset(rdata, select = -v)
rdata <- subset(rdata, select = -Effect.size.code)
alllong$es_longevity <- alllong$es
alllong$v_longevity <- alllong$v
alllong <- subset(alllong, select = -es)
alllong <- subset(alllong, select = -v)
alllong <- subset(alllong, select = -Effect.size.code)
df <- merge(rdata, alllong, all=TRUE)
df <- subset(df, select = -(Trait.category))
df <- subset(df, select = -(Trait))
df <- df[,-1]
df <- subset(df, select = -Effect.size.code)
View(rdata)
View(alllong)
View(df)
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
### Read in effect size data
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
rdata$es_reproduction <- rdata$es
rdata$v_reproduction <- rdata$v
rdata <- subset(rdata, select = -es)
rdata <- subset(rdata, select = -v)
rdata <- subset(rdata, select = -Effect.size.code)
alllong$es_longevity <- alllong$es
alllong$v_longevity <- alllong$v
alllong <- subset(alllong, select = -es)
alllong <- subset(alllong, select = -v)
alllong <- subset(alllong, select = -Effect.size.code)
df <- merge(rdata, alllong, all=TRUE)
df <- subset(df, select = -(Trait.category))
df <- subset(df, select = -(Trait))
write.csv(df, here("Data", "Combined_effectsizes.csv"))
write.csv(df, here("Data", "Combined_effectsizes.csv"))
colnames(rdata)
colnames(df)
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
### Read in effect size data
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
rdata$es_reproduction <- rdata$es
rdata$v_reproduction <- rdata$v
rdata <- subset(rdata, select = -es)
rdata <- subset(rdata, select = -v)
rdata <- subset(rdata, select = -(Trait.category))
rdata <- subset(rdata, select = -(Trait))
rdata <- subset(rdata, select = -Effect.size.code)
alllong$es_longevity <- alllong$es
alllong$v_longevity <- alllong$v
alllong <- subset(alllong, select = -es)
alllong <- subset(alllong, select = -v)
alllong <- subset(alllong, select = -(Trait.category))
alllong <- subset(alllong, select = -(Trait))
alllong <- subset(alllong, select = -Effect.size.code)
df <- merge(rdata, alllong, all=TRUE)
View(df)
df <- subset(df, select = -(Trait.category))
View(df)
View(df)
1381+1423
View(df)
df_cleaned <- df[!is.na(df$es.reproduction), ]
df_cleaned <- df_cleaned[!is.na(df_cleaned$es.longevity), ]
df_cleaned <- df[!is.na(df$es.reproduction), ]
View(df)
!is.na(df$es.reproduction)
df_cleaned <- df[!is.na(df$es_reproduction), ]
df_cleaned <- df_cleaned[!is.na(df_cleaned$es_longevity), ]
View(df_cleaned)
View(df_cleaned)
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
### Read in effect size data
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
rdata$es_reproduction <- rdata$es
rdata$v_reproduction <- rdata$v
rdata <- subset(rdata, select = -es)
rdata <- subset(rdata, select = -v)
rdata <- subset(rdata, select = -(Trait.category))
rdata <- subset(rdata, select = -(Trait))
rdata <- subset(rdata, select = -Effect.size.code)
alllong$es_longevity <- alllong$es
alllong$v_longevity <- alllong$v
alllong <- subset(alllong, select = -es)
alllong <- subset(alllong, select = -v)
alllong <- subset(alllong, select = -(Trait.category))
alllong <- subset(alllong, select = -(Trait))
alllong <- subset(alllong, select = -Effect.size.code)
df <- merge(rdata, alllong, all=TRUE)
write.csv(df, here("Data", "Combined_effectsizes.csv"))
View(df)
df_cleaned <- df[!is.na(u_combo$es_reproduction), ]
df_cleaned <- df_cleaned[!is.na(df_cleaned$es.longevity), ]
df_cleaned <- df[!is.na(df$es_reproduction), ]
df_cleaned <- df_cleaned[!is.na(df_cleaned$es.longevity), ]
df_cleaned <- df_cleaned[!is.na(df_cleaned$es_longevity), ]
df_cleaned <- df[!is.na(df$es_reproduction), ]
df_cleaned <- df_cleaned[!is.na(df_cleaned$es_longevity), ]
write.csv(df_cleaned, "Data/cleaned_unique_combo.csv")
View(df)
View(df)
which(df$Sex == "Both")
df$Experiment.code[which(df$Sex == "Both"),]
df$Experiment.code[which(df$Sex == "Both")]
unique(df$Experiment.code[which(df$Sex == "Both")])
to.fix <- unique(df$Experiment.code[which(df$Sex == "Both")])
to.fix <- as.vector(to.fix)
write.csv(to.fix, "to.fix.csv")
View(rdata)
View(alllong)
df[which(df$Paper.code == "HUM302")])
df[which(df$Paper.code == "HUM302")]
df[which(df$Paper.code == "HUM302"),]
rdata[which(df$rdata== "HUM302"),]
rdata[which(df$rdata == "HUM302"),]
rdata[which(rdata$Paper.code == "HUM302"),]
alllong[which(alllong$Paper.code == "HUM302"),]
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
### Read in effect size data
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
rdata$es_reproduction <- rdata$es
rdata$v_reproduction <- rdata$v
rdata <- subset(rdata, select = -es)
rdata <- subset(rdata, select = -v)
rdata <- subset(rdata, select = -(Trait.category))
rdata <- subset(rdata, select = -(Trait))
rdata <- subset(rdata, select = -Effect.size.code)
alllong$es_longevity <- alllong$es
alllong$v_longevity <- alllong$v
alllong <- subset(alllong, select = -es)
alllong <- subset(alllong, select = -v)
alllong <- subset(alllong, select = -(Trait.category))
alllong <- subset(alllong, select = -(Trait))
alllong <- subset(alllong, select = -Effect.size.code)
df <- merge(rdata, alllong, all=TRUE)
View(df)
write.csv(df, here("Data", "Combined_effectsizes.csv"))
df_cleaned <- df[!is.na(df$es_reproduction), ]
df_cleaned <- df_cleaned[!is.na(df_cleaned$es_longevity), ]
write.csv(df_cleaned, "Data/cleaned_unique_combo.csv")
to.fix <- unique(df$Experiment.code[which(df$Sex == "Both")])
to.fix <- as.vector(to.fix)
write.csv(to.fix, "to.fix.csv")
write.csv(to.fix, "to.fix.csv")
## Load in the finalised data
data <- read.csv(here("data", "cleaned_unique_combo.csv"))
## Load in the finalised data
data <- read.csv(here("data", "cleaned_unique_combo.csv"))
## Load in the finalised data
data <- read.csv(here("data", "cleaned_unique_combo.csv"))
#  Let's just orient the data length wise as we need it in this format first.
data_long <- data %>% pivot_longer(cols = c(es.reproduction, es.longevity, v.reproduction, v.longevity), names_to = "outcome", values_to = "es") %>% data.frame()
#  Let's just orient the data length wise as we need it in this format first.
data_long <- data %>% pivot_longer(cols = c(es.reproduction, es.longevity, v.reproduction, v.longevity), names_to = "outcome", values_to = "es") %>% data.frame()
#  Let's just orient the data length wise as we need it in this format first.
data_long <- data %>% pivot_longer(cols = c(es.reproduction, es.longevity, v.reproduction, v.longevity), names_to = "outcome", values_to = "es") %>% data.frame()
data_long <- data %>% pivot_longer(cols = c(es_reproduction, es_longevity, v_reproduction, v_longevity), names_to = "outcome", values_to = "es") %>% data.frame()
# Not quite where we need it, so lets filter out v and then cbind together
data_long_es <- data_long %>% filter(outcome %in% c("es_reproduction", "es_longevity"))
data_long_v <- data_long %>% filter(outcome %in% c("v_reproduction", "v_longevity"))
# All information should now be ordered correctly and the data frames the same dimensions. We can check
dim(data_long_es)
dim(data_long_v)
# Now, bind these together
data_long_final <- cbind(data_long_es, v = data_long_v$es)
# Create unique ID for clustered effects
data_long_final$trial <- with(data_long_final, interaction(Experiment.code, diff, Species.latin))
# Now, let's check that this data is set up correctly. If we group by Experiment.code, diff and outcome then we should have a maximum of 1 effect size for each study/diff in each outcome category
check <- data_long_final %>% group_by(trial, outcome) %>% summarise(n=n()) %>% filter(n !=1)
View(check)
# Create unique ID for clustered effects
data_long_final$trial <- with(data_long_final, interaction(Experiment.code, diff))
# Now, let's check that this data is set up correctly. If we group by Experiment.code, diff and outcome then we should have a maximum of 1 effect size for each study/diff in each outcome category
check <- data_long_final %>% group_by(trial, outcome) %>% summarise(n=n()) %>% filter(n !=1)
(check$trial)
# The Experiment code identifiers that are relevant are:
unique(check$trial)
View(data)
View(data)
View(data)
View(data)
# The Experiment code identifiers that are relevant are:
sort(unique(check$trial))
sort(unique(check$trial))
order(unique(check$trial))
class(unique(check$trial))
as.character(unique(check$trial))
duplicate.exp.code <- as.character(unique(check$trial))
sort(duplicate.exp.code)
setwd("~/GitHub/Thermal_Fertility_Meta-Analysis/EDA/Fixing raw data issues")
write.csv(as.vector(sort(duplicate.exp.code)), "duplicated.expcodes.csv")
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
View(effectdata)
which(effectdata$Paper == "HUM316")
which(effectdata$Paper.code == "HUM316")
effectdata[which(effectdata$Paper.code == "HUM316"),]
### Read in effect size data
effectdata <- read.csv(here("Data", "Survival project all pairwise.es.csv"))
effectdata <-  subset(effectdata, Paper.code != "HUM251")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
rdata <- rbind(repdata_warm, repdata_cool)
### Read in effect size data
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
rdata$es_reproduction <- rdata$es
rdata$v_reproduction <- rdata$v
rdata <- subset(rdata, select = -es)
rdata <- subset(rdata, select = -v)
rdata <- subset(rdata, select = -(Trait.category))
rdata <- subset(rdata, select = -(Trait))
rdata <- subset(rdata, select = -Effect.size.code)
alllong$es_longevity <- alllong$es
alllong$v_longevity <- alllong$v
alllong <- subset(alllong, select = -es)
alllong <- subset(alllong, select = -v)
alllong <- subset(alllong, select = -(Trait.category))
alllong <- subset(alllong, select = -(Trait))
alllong <- subset(alllong, select = -Effect.size.code)
df <- merge(rdata, alllong, all=TRUE)
View(df)
write.csv(df, here("Data", "Combined_effectsizes.csv"))
df_cleaned <- df[!is.na(df$es_reproduction), ]
df_cleaned <- df_cleaned[!is.na(df_cleaned$es_longevity), ]
write.csv(df_cleaned, "Data/cleaned_unique_combo.csv")
setwd("~/GitHub/Thermal_Fertility_Meta-Analysis")
setwd("~/GitHub/Thermal_Fertility_Meta-Analysis")
write.csv(df, here("Data", "Combined_effectsizes.csv"))
df_cleaned <- df[!is.na(df$es_reproduction), ]
df_cleaned <- df_cleaned[!is.na(df_cleaned$es_longevity), ]
write.csv(df_cleaned, "Data/cleaned_unique_combo.csv")
View(df_cleaned)
## Load in the finalised data
data <- read.csv(here("data", "cleaned_unique_combo.csv"))
data_long <- data %>% pivot_longer(cols = c(es_reproduction, es_longevity, v_reproduction, v_longevity), names_to = "outcome", values_to = "es") %>% data.frame()
# Not quite where we need it, so lets filter out v and then cbind together
data_long_es <- data_long %>% filter(outcome %in% c("es_reproduction", "es_longevity"))
data_long_v <- data_long %>% filter(outcome %in% c("v_reproduction", "v_longevity"))
# All information should now be ordered correctly and the data frames the same dimensions. We can check
dim(data_long_es)
dim(data_long_v)
# Now, bind these together
data_long_final <- cbind(data_long_es, v = data_long_v$es)
# Create unique ID for clustered effects
data_long_final$trial <- with(data_long_final, interaction(Experiment.code, diff))
# Now, let's check that this data is set up correctly. If we group by Experiment.code, diff and outcome then we should have a maximum of 1 effect size for each study/diff in each outcome category
check <- data_long_final %>% group_by(trial, outcome) %>% summarise(n=n()) %>% filter(n !=1)
# The Experiment code identifiers that are relevant are:
unique(check$trial)
View(df)
