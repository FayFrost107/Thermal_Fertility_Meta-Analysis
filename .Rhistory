sub$Species.latin[which(sub$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
sub$Species.latin[which(sub$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
sub$Species.latin[which(sub$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
sub$Species.latin[which(sub$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
sub$Species.latin[which(sub$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
sub$Species.latin[which(sub$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
sub$Species.latin[which(sub$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
sub$Species.latin[which(sub$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
sub$Species.latin[which(sub$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
sub$Species.latin[which(sub$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
### specify classifications from map
sub$Class <- classes$class[match(sub$Species.latin, classes$species_latin)]
## number of each class
table(sub$Class)
# How many papers does each species occur in
unique_combinations <- sub %>%
distinct(Paper.code, Species.latin)
# Count the number of unique studies for each species
species_counts <- unique_combinations %>%
group_by(Species.latin) %>%
summarize(UniqueStudies = n())
table(unique_combinations)
table(species_counts)
unique_combinations
table(sub$Class)
table(unique_combinations)
table(species_counts)
View(unique_combinations)
length(unique_combinations$Species.latin)
length(unique(unique_combinations$Species.latin))
table(sub$Class)
rm(list=ls())
library(rotl)
library(tidyr)
library(dplyr)
library(ape)
library(ggplot2)
library(ggtree)
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
### select data for tree
rdata <- allrep
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
setwd("C:/Users/ff242/Desktop/Liverpool PDRA/Survival project/Survival Trees")
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
survdata_warm <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Warm" )
survdata_cool <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Cool" )
allrep <- rbind(repdata_warm, repdata_cool)
alllong <- rbind(longdata_warm, longdata_cool)
allsurv <- rbind(survdata_warm, survdata_cool)
### select data for tree
rdata <- allrep
rdata <- subset(rdata, Paper.code != "HUM251")
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
survdata_warm <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Warm" )
survdata_cool <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Cool" )
allrep <- rbind(repdata_warm, repdata_cool)
alllong <- rbind(longdata_warm, longdata_cool)
allsurv <- rbind(survdata_warm, survdata_cool)
### select data for tree
rdata <- allrep
rdata <- subset(rdata, Paper.code != "HUM251")
rdata$Species.latin[which(rdata$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
rdata$Species.latin[which(rdata$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
rdata$Species.latin[which(rdata$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
rdata$Species.latin[which(rdata$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
rdata$Species.latin[which(rdata$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
rdata$Species.latin[which(rdata$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
rdata$Species.latin[which(rdata$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
rdata$Species.latin[which(rdata$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
rdata$Species.latin[which(rdata$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
rdata$Species.latin[which(rdata$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
rdata$Species.latin[which(rdata$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
rdata$Species.latin[which(rdata$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
rdata$Species.latin[which(rdata$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
rdata$Species.latin[which(rdata$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
rdata$Species.latin[which(rdata$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
rdata$Species.latin[which(rdata$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
rdata$Species.latin[which(rdata$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
rdata$Species.latin[which(rdata$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
rdata$Species.latin[which(rdata$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
### Problem species from systematic map to classes
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea ashmeadi")]              <- 	"Gonatocerus ashmeadi"
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea triguttata")]   <- "Gonatocerus triguttatus"
#rdata$Species.latin[which(rdata$Species.latin == "Mythimna albipuncta")]            <-  "Mythimna roseilinea"
rdata$Species.latin[which(rdata$Species.latin == "Daphnia australis")]            <-  "Daphniopsis australis"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
## prune tree
prune_tree <- drop.tip(tree_grafen, notin)
write.nexus(prune_tree, file="all_rep_excHUM251_tree.nex")
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
survdata_warm <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Warm" )
survdata_cool <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Cool" )
allrep <- rbind(repdata_warm, repdata_cool)
alllong <- rbind(longdata_warm, longdata_cool)
allsurv <- rbind(survdata_warm, survdata_cool)
### select data for tree
rdata <- allrep
rdata <- subset(rdata, Paper.code != "HUM251")
nlevels(rdata$Species.latin)
nlevels(as.factor(rdata$Species.latin))
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
allrep <- rbind(repdata_warm, repdata_cool)
### select data for tree
rdata <- allrep
rdata <- subset(rdata, Paper.code != "HUM251")
nlevels(as.factor(rdata$Species.latin))
rdata$Species.latin[which(rdata$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
rdata$Species.latin[which(rdata$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
rdata$Species.latin[which(rdata$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
rdata$Species.latin[which(rdata$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
rdata$Species.latin[which(rdata$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
rdata$Species.latin[which(rdata$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
rdata$Species.latin[which(rdata$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
rdata$Species.latin[which(rdata$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
rdata$Species.latin[which(rdata$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
rdata$Species.latin[which(rdata$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
rdata$Species.latin[which(rdata$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
rdata$Species.latin[which(rdata$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
rdata$Species.latin[which(rdata$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
rdata$Species.latin[which(rdata$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
rdata$Species.latin[which(rdata$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
rdata$Species.latin[which(rdata$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
rdata$Species.latin[which(rdata$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
rdata$Species.latin[which(rdata$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
rdata$Species.latin[which(rdata$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
### Problem species from systematic map to classes
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea ashmeadi")]              <- 	"Gonatocerus ashmeadi"
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea triguttata")]   <- "Gonatocerus triguttatus"
#rdata$Species.latin[which(rdata$Species.latin == "Mythimna albipuncta")]            <-  "Mythimna roseilinea"
rdata$Species.latin[which(rdata$Species.latin == "Daphnia australis")]            <-  "Daphniopsis australis"
nlevels(as.factor(rdata$Species.latin))
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
## prune tree
prune_tree <- drop.tip(tree_grafen, notin)
write.nexus(prune_tree, file="all_rep_excHUM251_tree.nex")
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
### select data for tree
rdata <- alllong
rdata <- subset(rdata, Paper.code != "HUM251")
rdata$Species.latin[which(rdata$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
rdata$Species.latin[which(rdata$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
rdata$Species.latin[which(rdata$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
rdata$Species.latin[which(rdata$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
rdata$Species.latin[which(rdata$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
rdata$Species.latin[which(rdata$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
rdata$Species.latin[which(rdata$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
rdata$Species.latin[which(rdata$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
rdata$Species.latin[which(rdata$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
rdata$Species.latin[which(rdata$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
rdata$Species.latin[which(rdata$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
rdata$Species.latin[which(rdata$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
rdata$Species.latin[which(rdata$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
rdata$Species.latin[which(rdata$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
rdata$Species.latin[which(rdata$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
rdata$Species.latin[which(rdata$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
rdata$Species.latin[which(rdata$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
rdata$Species.latin[which(rdata$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
rdata$Species.latin[which(rdata$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
### Problem species from systematic map to classes
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea ashmeadi")]              <- 	"Gonatocerus ashmeadi"
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea triguttata")]   <- "Gonatocerus triguttatus"
#rdata$Species.latin[which(rdata$Species.latin == "Mythimna albipuncta")]            <-  "Mythimna roseilinea"
rdata$Species.latin[which(rdata$Species.latin == "Daphnia australis")]            <-  "Daphniopsis australis"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
## prune tree
prune_tree <- drop.tip(tree_grafen, notin)
write.nexus(prune_tree, file="all_long_excHUM251_tree.nex")
View(tree1)
View(prune_tree)
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
survdata_warm <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Warm" )
survdata_cool <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Cool" )
allsurv <- rbind(survdata_warm, survdata_cool)
### select data for tree
rdata <- allsurv
rdata <- subset(rdata, Paper.code != "HUM251")
rdata$Species.latin[which(rdata$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
rdata$Species.latin[which(rdata$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
rdata$Species.latin[which(rdata$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
rdata$Species.latin[which(rdata$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
rdata$Species.latin[which(rdata$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
rdata$Species.latin[which(rdata$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
rdata$Species.latin[which(rdata$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
rdata$Species.latin[which(rdata$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
rdata$Species.latin[which(rdata$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
rdata$Species.latin[which(rdata$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
rdata$Species.latin[which(rdata$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
rdata$Species.latin[which(rdata$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
rdata$Species.latin[which(rdata$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
rdata$Species.latin[which(rdata$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
rdata$Species.latin[which(rdata$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
rdata$Species.latin[which(rdata$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
rdata$Species.latin[which(rdata$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
rdata$Species.latin[which(rdata$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
rdata$Species.latin[which(rdata$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
### Problem species from systematic map to classes
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea ashmeadi")]              <- 	"Gonatocerus ashmeadi"
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea triguttata")]   <- "Gonatocerus triguttatus"
#rdata$Species.latin[which(rdata$Species.latin == "Mythimna albipuncta")]            <-  "Mythimna roseilinea"
rdata$Species.latin[which(rdata$Species.latin == "Daphnia australis")]            <-  "Daphniopsis australis"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
## prune tree
prune_tree <- drop.tip(tree_grafen, notin)
write.nexus(prune_tree, file="all_surv_excHUM251_tree.nex")
# get effectsize data
effectdata <- read.csv("Data/Survival project all pairwise.es.csv")
sub <- subset(effectdata, warm.cool != "Reference")
table(sub$Class)
## percentage effect sizes of each class
table(sub$Class)/3780 * 100
## percentage effect sizes of each class
table(sub$Class)/nrow(sub) * 100
# How many papers in total
nlevels(as.factor(sub$Paper.code))
1387+1377
2849-2764
1377+1387+85
insect <- subset(sub, Class == "Insecta")
arach <- subset(sub, Class == "Arachnida")
crus <- subset(sub, Class == "Crustacea")
rot <- subset(sub, Class == "Rotifera")
ann <- subset(sub, Class == "Annelida")
# How many papers does each species occur in
unique_combinations <- sub %>%
distinct(Paper.code, Species.latin)
library(dplyr)
library(tidyr)
library(dplyr)
# How many papers does each species occur in
unique_combinations <- sub %>%
distinct(Paper.code, Species.latin)
# Count the number of unique studies for each species
species_counts <- unique_combinations %>%
group_by(Species.latin) %>%
summarize(UniqueStudies = n())
# number of species
length(unique(unique_combinations$Species.latin))
species_counts
table(sub$Class)
nlevels(as.factor(insect$Species.latin))
nlevels(as.factor(insect$Species.latin))
nlevels(as.factor(arach$Species.latin))
nlevels(as.factor(crus$Species.latin))
nlevels(as.factor(rot$Species.latin))
nlevels(as.factor(ann$Species.latin))
unique_combinations <- sub %>%
distinct(Paper.code, Species.latin)
# Count the number of unique studies for each species
species_counts <- unique_combinations %>%
group_by(Species.latin) %>%
summarize(UniqueStudies = n())
# number of species
length(unique(unique_combinations$Species.latin))
View(unique_combinations)
View(species_counts)
# Terrestiral versus aquatic
unique_habitat <- sub %>%
distinct(Species.latin, Habitat)
# Count the number of unique studies for each species
habitat_counts <- unique_habitat %>%
group_by(Habitat) %>%
summarize(UniqueStudies = n())
tale(habitat_counts)
table(habitat_counts)
table(unique_habitat)
habitat_counts
# Count the number of unique studies for each species
habitat2_counts <- unique_habitat2 %>%
group_by(Habitat2) %>%
summarize(UniqueStudies = n())
unique_habitat2 <- sub %>%
distinct(Species.latin, Habitat2)
# Count the number of unique studies for each species
habitat2_counts <- unique_habitat2 %>%
group_by(Habitat2) %>%
summarize(UniqueStudies = n())
habitat2_counts
# internal/external
unique_fert <- sub %>%
distinct(Species.latin, Fertilisation.mode)
# Count the number of unique studies for each species
fert_counts <- unique_fert %>%
group_by(Fertilisation.mode) %>%
summarize(UniqueStudies = n())
fert_counts
View(sub)
# sex/asexual
unique_sex <- sub %>%
distinct(Species.latin, reproductiove.mode)
# sex/asexual
unique_sex <- sub %>%
distinct(Species.latin, reproductive.mode)
# sex/asexual
unique_sex <- sub %>%
distinct(Species.latin, reprodctuive.mode)
# Count the number of unique studies for each species
sex_counts <- unique_sex %>%
group_by(reprodctuive.mode) %>%
summarize(UniqueStudies = n())
sex_counts
# exposure
unique_exp <- sub %>%
distinct(Experiment.code, Exposure.duration)
# Count the number of exposure times for each study
exp_counts <- unique_exp %>%
group_by(Exposure.duration) %>%
summarize(UniqueStudies = n())
exp_counts
# lab study
unique_lab <- sub %>%
distinct(Experiment.code, Lab.or.field)
# Count the number of lab studies for each study
lab_counts <- unique_lab %>%
group_by(Lab.or.field) %>%
summarize(UniqueStudies = n())
lab_counts
rm(list=ls())
library(rotl)
library(tidyr)
library(dplyr)
library(ape)
library(ggplot2)
library(ggtree)
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
############################# import full map tree ################################################
tree1 <- read.nexus("Phylogenycomplete_tree_draft.nex")
############################# import full map tree ################################################
tree1 <- read.nexus("Phylogeny/complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
rdata <- subset(effectdata, warm.cool !- "Reference")
rdata <- subset(effectdata, warm.cool != "Reference")
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
### Read in effect size data
effectdata <- read.csv("Data/Survival project all pairwise.es.csv")
rdata <- subset(effectdata, warm.cool != "Reference")
### Problem species from systematic map to classes
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea ashmeadi")]              <- 	"Gonatocerus ashmeadi"
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea triguttata")]   <- "Gonatocerus triguttatus"
#rdata$Species.latin[which(rdata$Species.latin == "Mythimna albipuncta")]            <-  "Mythimna roseilinea"
rdata$Species.latin[which(rdata$Species.latin == "Daphnia australis")]            <-  "Daphniopsis australis"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
## prune tree
prune_tree <- drop.tip(tree_grafen, notin)
rdata$Species.latin[which(rdata$Species.latin == "Mythimna albipuncta")]            <-  "Mythimna roseilinea"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
rdata$Species.latin[which(rdata$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
## prune tree
prune_tree <- drop.tip(tree_grafen, notin)
write.nexus(prune_tree, file="complete_tree.nex")
plot_data <- c()
plot_data$species_latin <- indata
plot_data$class <- effectdata$Class
plot_data <- as.data.frame(unique(plot_data))
plot_data$class <- rdata$Class[match(indata, rdata$Species_latin)]
View(plot_data)
View(plot_data)
match(indata, rdata$Species_latin)
rdata$Species.latin
indata
class(indata)
class(rdata$Species.latin)
match(indata, rdata$Species.latin)
rdata$Class
plot_data$class <- rdata$Class[match(indata, rdata$Species.latin)]
plot_data <- c()
plot_data$species_latin <- indata
plot_data$class <- rdata$Class[match(indata, rdata$Species.latin)]
plot_data <- as.data.frame(unique(plot_data))
View(plot_data)
colnames(plot_data) <- c("species_latin", "class")
ggtree(prune_tree, layout = "circular", lwd = 0.1) %<+% plot_data +
geom_tiplab(size=1.2, offset=0.01) +
aes(col = class)
ggtree(prune_tree, layout = "circular", lwd = 0.1) %<+% plot_data +
geom_tiplab(size=2, offset=0.01) +
aes(col = class)
rm(list=ls())
library(rotl)
library(tidyr)
library(dplyr)
library(ape)
library(ggplot2)
library(ggtree)
############################# import full map tree ################################################
tree1 <- read.nexus("Phylogeny/complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Data/Survival project all pairwise.es.csv")
rdata <- subset(effectdata, warm.cool != "Reference")   <<<<< select for all data
### Problem species from systematic map to classes
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea ashmeadi")]              <- 	"Gonatocerus ashmeadi"
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea triguttata")]   <- "Gonatocerus triguttatus"
read.nexus("Phylogeny/complete_tree_draft.nex")
############################# import full map tree ################################################
tree1 <- read.nexus("Phylogeny/complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Data/Survival project all pairwise.es.csv")
rdata <- subset(effectdata, warm.cool != "Reference")   #<<<<< select for all data
### Problem species from systematic map to classes
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea ashmeadi")]              <- 	"Gonatocerus ashmeadi"
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea triguttata")]   <- "Gonatocerus triguttatus"
rdata$Species.latin[which(rdata$Species.latin == "Daphnia australis")]            <-  "Daphniopsis australis"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
rdata$Species.latin[which(rdata$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
## prune tree
prune_tree <- drop.tip(tree_grafen, notin)
plot_data <- c()
plot_data$species_latin <- indata
plot_data$class <- rdata$Class[match(indata, rdata$Species.latin)]
plot_data <- as.data.frame(unique(plot_data))
colnames(plot_data) <- c("species_latin", "class")
ggtree(prune_tree, layout = "circular", lwd = 0.1) %<+% plot_data +
geom_tiplab(size=2, offset=0.01) +
aes(col = class)
