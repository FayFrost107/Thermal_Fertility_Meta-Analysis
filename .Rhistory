crus <- subset(sub, Class == "Crustacea")
length(unique(crus$Species.latin))
rot <- subset(sub, Class == "Rotifera")
length(unique(rot$Species.latin))
ann <- subset(sub, Class == "Annelida")
length(unique(ann$Species.latin))
sort(table(sub$Species.latin))
View(sub)
sub %>% distinct(Paper.code, Species.latin)
library(dplyr)
sub %>% distinct(Paper.code, Species.latin)
# How many papers does each species occur in
unique_combinations <- sub %>%
distinct(Paper.code, species.latin)
# How many papers does each species occur in
unique_combinations <- sub %>%
distinct(Paper.code, Species.latin)
# Count the number of unique studies for each species
species_counts <- unique_combinations %>%
group_by(Species.latin) %>%
summarize(UniqueStudies = n())
View(species_counts)
table(sub$Habitat)
unique_habitat <- sub %>%
distinct(Paper.code, Habitat)
# Count the number of unique studies for each species
habitat_counts <- unique_habitat %>%
group_by(Habitat) %>%
summarize(UniqueStudies = n())
View(unique_habitat)
unique_habitat <- sub %>%
distinct(Species.latin, Habitat)
# Count the number of unique studies for each species
habitat_counts <- unique_habitat %>%
group_by(Habitat) %>%
summarize(UniqueStudies = n())
table(habitat_counts)
281+30
unique(habitat_counts)
239+47+17+6
View(unique_habitat)
unique(unique_habitat$Species.latin)
duplicated(unique_habitat$Species.latin)
which(duplicated(unique_habitat$Species.latin))
unique_habitat$Species.latin[which(duplicated(unique_habitat$Species.latin)),]
unique_habitat$Species.latin[which(duplicated(unique_habitat$Species.latin))]
effectdata <- read.csv("Data/Survival project all pairwise.es.csv")
sub <- subset(effectdata, warm.cool != "Reference")
########### change species names in survival data ####################################
classes <- read.csv("Data/Species_classifications.CSV") ## read in species classifications from map
sub$Species.latin[which(sub$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
sub$Species.latin[which(sub$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
sub$Species.latin[which(sub$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
sub$Species.latin[which(sub$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
sub$Species.latin[which(sub$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
sub$Species.latin[which(sub$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
sub$Species.latin[which(sub$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
sub$Species.latin[which(sub$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
sub$Species.latin[which(sub$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
sub$Species.latin[which(sub$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
sub$Species.latin[which(sub$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
sub$Species.latin[which(sub$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
sub$Species.latin[which(sub$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
sub$Species.latin[which(sub$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
sub$Species.latin[which(sub$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
sub$Species.latin[which(sub$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
sub$Species.latin[which(sub$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
sub$Species.latin[which(sub$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
sub$Species.latin[which(sub$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
### specify classifications from map
sub$Class <- classes$class[match(sub$Species.latin, classes$species_latin)]
## number of each class
table(sub$Class)
insect <- subset(sub, Class == "Insecta")
arach <- subset(sub, Class == "Arachnida")
crus <- subset(sub, Class == "Crustacea")
rot <- subset(sub, Class == "Rotifera")
ann <- subset(sub, Class == "Annelida")
# How many papers does each species occur in
unique_combinations <- sub %>%
distinct(Paper.code, Species.latin)
# Count the number of unique studies for each species
species_counts <- unique_combinations %>%
group_by(Species.latin) %>%
summarize(UniqueStudies = n())
# Terrestiral versus aquatic
unique_habitat <- sub %>%
distinct(Species.latin, Habitat)
# Count the number of unique studies for each species
habitat_counts <- unique_habitat %>%
group_by(Habitat) %>%
summarize(UniqueStudies = n())
table(unique_habitat$Habitat)
View(sub)
# Terrestiral versus aquatic
unique_fert <- sub %>%
distinct(Species.latin, Fertilisation.mode)
# Count the number of unique studies for each species
fert_counts <- unique_fert %>%
group_by(Fertilisation.mode) %>%
summarize(UniqueStudies = n())
View(fert_counts)
table(unique_fert)
table(fert_counts)
unique_fert
fert_counts
duplicated(unique_fert$Species.latin)
unique_fert$Species.latin[duplicated(unique_fert$Species.latin)]
View(unique_fert)
View(sub)
# lab study
unique_lab <- sub %>%
distinct(Species.latin, Lab.or.field)
# Count the number of unique studies for each species
lab_counts <- unique_lab %>%
group_by(Lab.or.field) %>%
summarize(UniqueStudies = n())
table(unique_lab)
table(lab_counts)
table(unique_lab$Lab.or.field)
table(unique_fert$Fertilisation.mode)
duplicated(unique_lab$Species.latin)
unique_lab$Species.latin[duplicated(unique_lab$Species.latin)]
# lab study
unique_lab <- sub %>%
distinct(Paper.code, Lab.or.field)
# Count the number of lab studies for each study
lab_counts <- unique_lab %>%
group_by(Lab.or.field) %>%
summarize(UniqueStudies = n())
table(unique_lab$Lab.or.field)
# lab study
unique_lab <- sub %>%
distinct(Experiment.code, Lab.or.field)
# Count the number of lab studies for each study
lab_counts <- unique_lab %>%
group_by(Lab.or.field) %>%
summarize(UniqueStudies = n())
table(unique_lab$Lab.or.field)
length(sub$Experiment.code)
length(unique(sub$Experiment.code))
# exposure
unique_exp <- sub %>%
distinct(Experiment.code, Exposure.duration)
# Count the number of exposure times for each study
exp_counts <- unique_exp %>%
group_by(Exposure.duration) %>%
summarize(UniqueStudies = n())
table(exp_counts)
table(unique_exp$Exposure.duration)
487+19
effectdata <- read.csv("Data/Survival project all pairwise.es.csv")
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
### select data for analysis
rdata <- alllong
rdata <- subset(rdata, Paper.code != "HUM251")
rdata <- rdata %>% mutate(c_treattemp = treattemp - 25)
########### change species names in survival data ####################################
classes <- read.csv("Data/Species_classifications.CSV") ## read in species classifications from map
rdata$Species.latin[which(rdata$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
rdata$Species.latin[which(rdata$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
rdata$Species.latin[which(rdata$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
rdata$Species.latin[which(rdata$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
rdata$Species.latin[which(rdata$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
rdata$Species.latin[which(rdata$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
rdata$Species.latin[which(rdata$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
rdata$Species.latin[which(rdata$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
rdata$Species.latin[which(rdata$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
rdata$Species.latin[which(rdata$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
rdata$Species.latin[which(rdata$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
rdata$Species.latin[which(rdata$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
rdata$Species.latin[which(rdata$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
rdata$Species.latin[which(rdata$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
rdata$Species.latin[which(rdata$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
rdata$Species.latin[which(rdata$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
rdata$Species.latin[which(rdata$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
rdata$Species.latin[which(rdata$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
rdata$Species.latin[which(rdata$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
### specify classifications from map
rdata$Class <- classes$class[match(rdata$Species.latin, classes$species_latin)]
table(rdata$Class)
table(rdata$Fertilisation.mode)
View(rdata)
table(rdata$Agricultural.importance)
rdata$Class[which(rdata$Species.latin == "Daphiopsis australis")]
rdata$Class[which(rdata$Species.latin == "Daphniopsis australis")]
library(readr)
Survival_project_all_data_xlsx_Other_effect_sizes <- read_csv("C:/Users/ff242/Desktop/Liverpool PDRA/Survival project/Survival Project Data/Other Sheets/Survival project all data.xlsx - Other effect sizes.csv")
View(Survival_project_all_data_xlsx_Other_effect_sizes)
other <- Survival_project_all_data_xlsx_Other_effect_sizes
head(other)
length(unique(other$`Paper code`))
View(Survival_project_all_data_xlsx_Other_effect_sizes)
effectdata <- read.csv("Data/Survival project all pairwise.es.csv")
sub <- subset(effectdata, warm.cool != "Reference")
########### change species names in survival data ####################################
classes <- read.csv("Data/Species_classifications.CSV") ## read in species classifications from map
sub$Species.latin[which(sub$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
sub$Species.latin[which(sub$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
sub$Species.latin[which(sub$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
sub$Species.latin[which(sub$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
sub$Species.latin[which(sub$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
sub$Species.latin[which(sub$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
sub$Species.latin[which(sub$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
sub$Species.latin[which(sub$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
sub$Species.latin[which(sub$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
sub$Species.latin[which(sub$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
sub$Species.latin[which(sub$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
sub$Species.latin[which(sub$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
sub$Species.latin[which(sub$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
sub$Species.latin[which(sub$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
sub$Species.latin[which(sub$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
sub$Species.latin[which(sub$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
sub$Species.latin[which(sub$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
sub$Species.latin[which(sub$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
sub$Species.latin[which(sub$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
### specify classifications from map
sub$Class <- classes$class[match(sub$Species.latin, classes$species_latin)]
View(effectdata)
## number of each class
table(sub$Class)
# get effectsize data
effectdata <- read.csv("Data/Survival project all pairwise.es.csv")
sub <- subset(effectdata, warm.cool != "Reference")
########### change species names in survival data ####################################
classes <- read.csv("Data/Species_classifications.CSV") ## read in species classifications from map
sub$Species.latin[which(sub$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
sub$Species.latin[which(sub$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
sub$Species.latin[which(sub$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
sub$Species.latin[which(sub$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
sub$Species.latin[which(sub$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
sub$Species.latin[which(sub$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
sub$Species.latin[which(sub$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
sub$Species.latin[which(sub$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
sub$Species.latin[which(sub$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
sub$Species.latin[which(sub$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
sub$Species.latin[which(sub$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
sub$Species.latin[which(sub$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
sub$Species.latin[which(sub$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
sub$Species.latin[which(sub$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
sub$Species.latin[which(sub$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
sub$Species.latin[which(sub$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
sub$Species.latin[which(sub$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
sub$Species.latin[which(sub$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
sub$Species.latin[which(sub$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
### specify classifications from map
sub$Class <- classes$class[match(sub$Species.latin, classes$species_latin)]
## number of each class
table(sub$Class)
# How many papers does each species occur in
unique_combinations <- sub %>%
distinct(Paper.code, Species.latin)
# Count the number of unique studies for each species
species_counts <- unique_combinations %>%
group_by(Species.latin) %>%
summarize(UniqueStudies = n())
table(unique_combinations)
table(species_counts)
unique_combinations
table(sub$Class)
table(unique_combinations)
table(species_counts)
View(unique_combinations)
length(unique_combinations$Species.latin)
length(unique(unique_combinations$Species.latin))
table(sub$Class)
rm(list=ls())
library(rotl)
library(tidyr)
library(dplyr)
library(ape)
library(ggplot2)
library(ggtree)
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
### select data for tree
rdata <- allrep
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
setwd("C:/Users/ff242/Desktop/Liverpool PDRA/Survival project/Survival Trees")
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
survdata_warm <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Warm" )
survdata_cool <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Cool" )
allrep <- rbind(repdata_warm, repdata_cool)
alllong <- rbind(longdata_warm, longdata_cool)
allsurv <- rbind(survdata_warm, survdata_cool)
### select data for tree
rdata <- allrep
rdata <- subset(rdata, Paper.code != "HUM251")
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
survdata_warm <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Warm" )
survdata_cool <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Cool" )
allrep <- rbind(repdata_warm, repdata_cool)
alllong <- rbind(longdata_warm, longdata_cool)
allsurv <- rbind(survdata_warm, survdata_cool)
### select data for tree
rdata <- allrep
rdata <- subset(rdata, Paper.code != "HUM251")
rdata$Species.latin[which(rdata$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
rdata$Species.latin[which(rdata$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
rdata$Species.latin[which(rdata$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
rdata$Species.latin[which(rdata$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
rdata$Species.latin[which(rdata$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
rdata$Species.latin[which(rdata$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
rdata$Species.latin[which(rdata$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
rdata$Species.latin[which(rdata$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
rdata$Species.latin[which(rdata$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
rdata$Species.latin[which(rdata$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
rdata$Species.latin[which(rdata$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
rdata$Species.latin[which(rdata$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
rdata$Species.latin[which(rdata$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
rdata$Species.latin[which(rdata$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
rdata$Species.latin[which(rdata$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
rdata$Species.latin[which(rdata$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
rdata$Species.latin[which(rdata$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
rdata$Species.latin[which(rdata$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
rdata$Species.latin[which(rdata$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
### Problem species from systematic map to classes
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea ashmeadi")]              <- 	"Gonatocerus ashmeadi"
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea triguttata")]   <- "Gonatocerus triguttatus"
#rdata$Species.latin[which(rdata$Species.latin == "Mythimna albipuncta")]            <-  "Mythimna roseilinea"
rdata$Species.latin[which(rdata$Species.latin == "Daphnia australis")]            <-  "Daphniopsis australis"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
## prune tree
prune_tree <- drop.tip(tree_grafen, notin)
write.nexus(prune_tree, file="all_rep_excHUM251_tree.nex")
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
survdata_warm <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Warm" )
survdata_cool <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Cool" )
allrep <- rbind(repdata_warm, repdata_cool)
alllong <- rbind(longdata_warm, longdata_cool)
allsurv <- rbind(survdata_warm, survdata_cool)
### select data for tree
rdata <- allrep
rdata <- subset(rdata, Paper.code != "HUM251")
nlevels(rdata$Species.latin)
nlevels(as.factor(rdata$Species.latin))
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
repdata_warm <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Warm" )
repdata_cool <- subset(effectdata, Trait.category == "Reproduction" & warm.cool == "Cool" )
allrep <- rbind(repdata_warm, repdata_cool)
### select data for tree
rdata <- allrep
rdata <- subset(rdata, Paper.code != "HUM251")
nlevels(as.factor(rdata$Species.latin))
rdata$Species.latin[which(rdata$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
rdata$Species.latin[which(rdata$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
rdata$Species.latin[which(rdata$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
rdata$Species.latin[which(rdata$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
rdata$Species.latin[which(rdata$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
rdata$Species.latin[which(rdata$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
rdata$Species.latin[which(rdata$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
rdata$Species.latin[which(rdata$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
rdata$Species.latin[which(rdata$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
rdata$Species.latin[which(rdata$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
rdata$Species.latin[which(rdata$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
rdata$Species.latin[which(rdata$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
rdata$Species.latin[which(rdata$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
rdata$Species.latin[which(rdata$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
rdata$Species.latin[which(rdata$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
rdata$Species.latin[which(rdata$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
rdata$Species.latin[which(rdata$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
rdata$Species.latin[which(rdata$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
rdata$Species.latin[which(rdata$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
### Problem species from systematic map to classes
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea ashmeadi")]              <- 	"Gonatocerus ashmeadi"
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea triguttata")]   <- "Gonatocerus triguttatus"
#rdata$Species.latin[which(rdata$Species.latin == "Mythimna albipuncta")]            <-  "Mythimna roseilinea"
rdata$Species.latin[which(rdata$Species.latin == "Daphnia australis")]            <-  "Daphniopsis australis"
nlevels(as.factor(rdata$Species.latin))
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
## prune tree
prune_tree <- drop.tip(tree_grafen, notin)
write.nexus(prune_tree, file="all_rep_excHUM251_tree.nex")
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
longdata_warm <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Warm" )
longdata_cool <- subset(effectdata, Trait.category == "Longevity" & warm.cool == "Cool" )
alllong <- rbind(longdata_warm, longdata_cool)
### select data for tree
rdata <- alllong
rdata <- subset(rdata, Paper.code != "HUM251")
rdata$Species.latin[which(rdata$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
rdata$Species.latin[which(rdata$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
rdata$Species.latin[which(rdata$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
rdata$Species.latin[which(rdata$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
rdata$Species.latin[which(rdata$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
rdata$Species.latin[which(rdata$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
rdata$Species.latin[which(rdata$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
rdata$Species.latin[which(rdata$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
rdata$Species.latin[which(rdata$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
rdata$Species.latin[which(rdata$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
rdata$Species.latin[which(rdata$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
rdata$Species.latin[which(rdata$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
rdata$Species.latin[which(rdata$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
rdata$Species.latin[which(rdata$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
rdata$Species.latin[which(rdata$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
rdata$Species.latin[which(rdata$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
rdata$Species.latin[which(rdata$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
rdata$Species.latin[which(rdata$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
rdata$Species.latin[which(rdata$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
### Problem species from systematic map to classes
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea ashmeadi")]              <- 	"Gonatocerus ashmeadi"
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea triguttata")]   <- "Gonatocerus triguttatus"
#rdata$Species.latin[which(rdata$Species.latin == "Mythimna albipuncta")]            <-  "Mythimna roseilinea"
rdata$Species.latin[which(rdata$Species.latin == "Daphnia australis")]            <-  "Daphniopsis australis"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
## prune tree
prune_tree <- drop.tip(tree_grafen, notin)
write.nexus(prune_tree, file="all_long_excHUM251_tree.nex")
View(tree1)
View(prune_tree)
############################# import full map tree ################################################
tree1 <- read.nexus("complete_tree_draft.nex")
tree_grafen = compute.brlen(tree1, method="Grafen", power=1)
### Read in effect size data
effectdata <- read.csv("Survival project all pairwise.es.csv")
survdata_warm <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Warm" )
survdata_cool <- subset(effectdata, Trait.category == "Survival" & warm.cool == "Cool" )
allsurv <- rbind(survdata_warm, survdata_cool)
### select data for tree
rdata <- allsurv
rdata <- subset(rdata, Paper.code != "HUM251")
rdata$Species.latin[which(rdata$Species.latin == "Marasmia exigua")]                <- "Cnaphalocrocis exigua"
rdata$Species.latin[which(rdata$Species.latin == "Matsumuratettix hieroglyphicus")] <- "Matsumuratettix hiroglyphicus"
rdata$Species.latin[which(rdata$Species.latin == "Mythimna roseilinea")]            <- "Mythimna albipuncta"
rdata$Species.latin[which(rdata$Species.latin == "Apis craccivora")]                <- "Aphis craccivora"
rdata$Species.latin[which(rdata$Species.latin == "Cryptoleamus montrouzieri")]      <- "Cryptolaemus montrouzieri"
rdata$Species.latin[which(rdata$Species.latin == "Asplanchna brightwelli")]         <- "Asplanchna brightwellii"
rdata$Species.latin[which(rdata$Species.latin == "Brennandania lambi")]             <- "Pygmephorus lambi"
rdata$Species.latin[which(rdata$Species.latin == "Amblyseius alstoniae")]           <- "Euseius alstoniae"
rdata$Species.latin[which(rdata$Species.latin == "Siphoninus phyllyreae")]          <- "Siphoninus phillyreae"
rdata$Species.latin[which(rdata$Species.latin == "Proprioseiopsis asetus")]         <- "Amblyseius asetus"
rdata$Species.latin[which(rdata$Species.latin == "Parabemisia myrica")]             <- "Parabemisia myricae"
rdata$Species.latin[which(rdata$Species.latin == "Cirrospilus sp. near lyncus")]    <- "Cirrospilus lyncus"
rdata$Species.latin[which(rdata$Species.latin == "Anagyrus sp. nov. nr. sinope" )]  <- "Anagyrus sinope"
rdata$Species.latin[which(rdata$Species.latin == "Monochamus leuconotus")]          <- "Anthores leuconotus"
rdata$Species.latin[which(rdata$Species.latin == "Ropalosiphum maidis")]            <- "Rhopalosiphum maidis"
rdata$Species.latin[which(rdata$Species.latin == "Artemia fransiscana")]            <- "Artemia franciscana"
rdata$Species.latin[which(rdata$Species.latin == "Blathyplectes curculionis")]      <- "Bathyplectes curculionis"
rdata$Species.latin[which(rdata$Species.latin == "Menochilus sexmaculatus")]        <- "Cheilomenes sexmaculata"
rdata$Species.latin[which(rdata$Species.latin == "unknown (Tominic)")]              <- "Trichogramma"
### Problem species from systematic map to classes
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea ashmeadi")]              <- 	"Gonatocerus ashmeadi"
rdata$Species.latin[which(rdata$Species.latin == "Cosmocomoidea triguttata")]   <- "Gonatocerus triguttatus"
#rdata$Species.latin[which(rdata$Species.latin == "Mythimna albipuncta")]            <-  "Mythimna roseilinea"
rdata$Species.latin[which(rdata$Species.latin == "Daphnia australis")]            <-  "Daphniopsis australis"
## import tree from map
notin <- setdiff(tree1$tip.label, rdata$Species.latin)
indata <- setdiff(tree1$tip.label, notin)
## number of indata should equal # of unique rdata species.
setdiff(unique(rdata$Species.latin), indata)
## prune tree
prune_tree <- drop.tip(tree_grafen, notin)
write.nexus(prune_tree, file="all_surv_excHUM251_tree.nex")
